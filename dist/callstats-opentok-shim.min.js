"use strict";var CallstatsOpenTok=function(){function n(n,e){if(null!==r){var t=r.webRTCFunctions[e];r.reportError(n,i,t)}}function e(e,t,r){return function(o){return n(e,t),r(o)}}var t=new Map,r=null,o=function(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return("x"==e?t:3&t|8).toString(16)})},i=null,a=null,c=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection;if(c){var l=function(l,s){var u=new c(l,s),f=o(),d=void 0;if(d=void 0===l?"unknown":l.capableSimulcastStreams?"publisher":"subscriber",t.set(f,{peerConnection:u,kind:d}),null!==r){var p=r.fabricUsage.multiplex;r.addNewFabric(u,f,p,i,function(n,e){console.log("Monitoring status: "+n+" msg: "+e)})}else console.warn("Callstats not connected");var v=u.getStats.bind(u);u.getStats=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length<=1)return a&&a(f,u),v.apply(void 0,t).catch(function(e){throw n(u,"getStats"),e});var o=t[0],i=t[1];return v(function(n){if(a&&a(f,u),o)return o(n)},i)};var w=u.createOffer.bind(u);u.createOffer=function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];if(r.length<=1)return w.apply(void 0,r).catch(function(e){throw n(u,"createOffer"),e});var i=r[0],a=r[1],c=r[2],l=e(u,"createOffer",c);return w(i,a,c,l)};var x=u.createAnswer.bind(u);u.createAnswer=function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];if(r.length<=1)return x.apply(void 0,r).catch(function(e){throw n(u,"createAnswer"),e});var i=r[0],a=r[1],c=r[2],l=e(u,"createAnswer",c);return x(i,a,l)};var g=u.setLocalDescription.bind(u);u.setLocalDescription=function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];if(r.length<=1)return g.apply(void 0,r).catch(function(e){throw n(u,"setLocalDescription"),e});var i=r[0],a=r[1],c=r[2],l=e(u,"setLocalDescription",c);return g(i,a,l)};var h=u.setRemoteDescription.bind(u);u.setRemoteDescription=function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];if(r.length<=1)return h.apply(void 0,r).catch(function(e){throw n(u,"setRemoteDescription"),e});var i=r[0],a=r[1],c=r[2],l=e(u,"setRemoteDescription",c);return h(i,a,l)};var C=u.addIceCandidate.bind(u);return u.addIceCandidate=function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];if(r.length<=1)return C.apply(void 0,r).catch(function(e){throw n(u,"addIceCandidate"),e});var i=r[0],a=r[1],c=r[2],l=e(u,"addIceCandidate",c);return C(i,a,l)},u.onsignalingstatechange=function(n){"closed"==n.signalingState&&t.delete(f)},u};["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection"].forEach(function(n){window.hasOwnProperty(n)&&(window[n]=l,Object.keys(c).forEach(function(e){window[n][e]=c[e]}),window[n].prototype=c.prototype)})}return{initialize:function(n){var e=null,t=null,c=null,l=null;if("function"==typeof n.IdGenerator&&(o=n.IdGenerator),void 0!==n.AppId)if(void 0!==n.AppSecret){if(void 0!==n.SessionId)return i=n.SessionId,"function"==typeof n.OnConnection&&(a=n.OnConnection),void 0!==n.Id?e=n.Id:(console.info("Stats identifier not provided. Generating one ..."),e=o()),n.InitCallback&&(c=n.InitCallback),n.StatsCallback&&(t=n.StatsCallback),n.ConfigParams&&(l=n.ConfigParams),(r=new callstats).initialize(n.AppId,n.AppSecret,e,c,t,l),r;console.error("callstats SessionId is required")}else console.error("callstats AppSecret is required");else console.error("callstats AppId is required")},getConnections:function(){var n=new Map;return t.forEach(function(e,t){n.set(t,e)}),n}}}();
//# sourceMappingURL=callstats-opentok-shim.min.js.map